(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof module==="object"&&module.exports){module.exports=function(t,a){if(a===undefined){if(typeof window!=="undefined"){a=require("jquery")}else{a=require("jquery")(t)}}return e(a)}}else{e(window.jQuery)}})(function(e){var t,a;var i,r;e.extend(e.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"});e.extend(e.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUploadURL:"https://i.froala.com/upload",imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:false,imageUploadMethod:"POST",imageMaxSize:10*1024*1024,imageAllowedTypes:["jpeg","jpg","png","gif","svg+xml"],imageResize:true,imageResizeWithPercent:false,imageRoundPercent:false,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:false,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered"},imageMove:true,imageMultipleStyles:true,imageTextNear:true,imagePaste:true,imagePasteProcess:false,imageMinWidth:16,imageOutputSize:false,imageDefaultMargin:5});e.FE.PLUGINS.image=function(s){var n;var o;var l;var f;var d=false;var p=1;var g=2;var u=3;var c=4;var m=5;var v=6;var h=7;var b={};b[p]="Image cannot be loaded from the passed link.",b[g]="No link in upload response.",b[u]="Error during file upload.",b[c]="Parsing response failed.",b[m]="File is too large.",b[v]="Image file type is invalid.",b[h]="Files can be uploaded only to same domain in IE 8 and IE 9.";function y(){var e=s.popups.get("image.insert");var t=e.find(".fr-image-by-url-layer input");t.val("");if(n){t.val(n.attr("src"))}t.trigger("change")}function E(){var e=s.$tb.find('.fr-command[data-cmd="insertImage"]');var t=s.popups.get("image.insert");if(!t)t=ae();_();if(!t.hasClass("fr-active")){s.popups.refresh("image.insert");s.popups.setContainer("image.insert",s.$tb);if(e.is(":visible")){var a=e.offset().left+e.outerWidth()/2;var i=e.offset().top+(s.opts.toolbarBottom?10:e.outerHeight()-10);s.popups.show("image.insert",a,i,e.outerHeight())}else{s.position.forSelection(t);s.popups.show("image.insert")}}}function w(){var e=s.popups.get("image.edit");if(!e)e=O();if(e){s.popups.setContainer("image.edit",s.$sc);s.popups.refresh("image.edit");var t=n.offset().left+n.outerWidth()/2;var a=n.offset().top+n.outerHeight();s.popups.show("image.edit",t,a,n.outerHeight())}}function C(){_()}function A(e){if(!e.hasClass("fr-dii")&&!e.hasClass("fr-dib")){e.addClass("fr-fi"+Te(e)[0]);e.addClass("fr-di"+Ue(e)[0]);e.css("margin","");e.css("float","");e.css("display","");e.css("z-index","");e.css("position","");e.css("overflow","");e.css("vertical-align","")}}function S(e){var t=e.hasClass("fr-dib")?"block":e.hasClass("fr-dii")?"inline":null;var a=e.hasClass("fr-fil")?"left":e.hasClass("fr-fir")?"right":Te(e);ke(e,t,a);e.removeClass("fr-dib fr-dii fr-fir fr-fil")}function R(){var t=s.el.tagName=="IMG"?[s.el]:s.el.querySelectorAll("img");for(var a=0;a<t.length;a++){var i=e(t[a]);if(!s.opts.htmlUntouched&&s.opts.useClasses){if(s.opts.imageEditButtons.indexOf("imageAlign")>=0||s.opts.imageEditButtons.indexOf("imageDisplay")>=0){A(i)}if(!s.opts.imageTextNear){i.removeClass("fr-dii").addClass("fr-dib")}}else if(!s.opts.htmlUntouched&&!s.opts.useClasses){if(s.opts.imageEditButtons.indexOf("imageAlign")>=0||s.opts.imageEditButtons.indexOf("imageDisplay")>=0){S(i)}}if(s.opts.iframe){i.on("load",s.size.syncIframe)}}}var D;function x(t){if(typeof t==="undefined")t=true;var a=Array.prototype.slice.call(s.el.querySelectorAll("img"));var i=[];var r;for(r=0;r<a.length;r++){i.push(a[r].getAttribute("src"));e(a[r]).toggleClass("fr-draggable",s.opts.imageMove);if(a[r].getAttribute("class")==="")a[r].removeAttribute("class");if(a[r].getAttribute("style")==="")a[r].removeAttribute("style")}if(D){for(r=0;r<D.length;r++){if(i.indexOf(D[r].getAttribute("src"))<0){s.events.trigger("image.removed",[e(D[r])])}}}if(D&&t){var n=[];for(r=0;r<D.length;r++){n.push(D[r].getAttribute("src"))}for(r=0;r<a.length;r++){if(n.indexOf(a[r].getAttribute("src"))<0){s.events.trigger("image.loaded",[e(a[r])])}}}D=a}function $(){if(!o)me();if(!n)return false;var e=s.$wp||s.$sc;e.append(o);o.data("instance",s);var t=e.scrollTop()-(e.css("position")!="static"?e.offset().top:0);var a=e.scrollLeft()-(e.css("position")!="static"?e.offset().left:0);a-=s.helpers.getPX(e.css("border-left-width"));t-=s.helpers.getPX(e.css("border-top-width"));if(s.$el.is("img")&&s.$sc.is("body")){t=0;a=0}o.css("top",(s.opts.iframe?n.offset().top:n.offset().top+t)-1).css("left",(s.opts.iframe?n.offset().left:n.offset().left+a)-1).css("width",n.get(0).getBoundingClientRect().width).css("height",n.get(0).getBoundingClientRect().height).addClass("fr-active")}function I(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function k(t){if(!s.core.sameInstance(o))return true;t.preventDefault();t.stopPropagation();if(s.$el.find("img.fr-error").left)return false;if(!s.undo.canDo())s.undo.saveStep();var a=t.pageX||t.originalEvent.touches[0].pageX;if(t.type=="mousedown"){var i=s.$oel.get(0);var r=i.ownerDocument;var d=r.defaultView||r.parentWindow;var p=false;try{p=d.location!=d.parent.location}catch(e){}if(p&&d.frameElement){a+=s.helpers.getPX(e(d.frameElement).offset().left)+d.frameElement.clientLeft}}l=e(this);l.data("start-x",a);l.data("start-width",n.width());l.data("start-height",n.height());var g=n.width();if(s.opts.imageResizeWithPercent){var u=n.parentsUntil(s.$el,s.html.blockTagsQuery()).get(0)||s.el;n.css("width",(g/e(u).outerWidth()*100).toFixed(2)+"%")}else{n.css("width",g)}f.show();s.popups.hideAll();$e()}function F(t){if(!s.core.sameInstance(o))return true;var a;if(l&&n){t.preventDefault();if(s.$el.find("img.fr-error").left)return false;var i=t.pageX||(t.originalEvent.touches?t.originalEvent.touches[0].pageX:null);if(!i){return false}var r=l.data("start-x");var f=i-r;var d=l.data("start-width");if(l.hasClass("fr-hnw")||l.hasClass("fr-hsw")){f=0-f}if(s.opts.imageResizeWithPercent){var p=n.parentsUntil(s.$el,s.html.blockTagsQuery()).get(0)||s.el;d=((d+f)/e(p).outerWidth()*100).toFixed(2);if(s.opts.imageRoundPercent)d=Math.round(d);n.css("width",d+"%");a=(s.helpers.getPX(n.css("width"))/e(p).outerWidth()*100).toFixed(2);if(a!==d){n.css("width",a+"%")}n.css("height","").removeAttr("height")}else{if(d+f>=s.opts.imageMinWidth){n.css("width",d+f)}a=s.helpers.getPX(n.css("width"));if(a!==d+f){n.css("width",a)}n.css("height",l.data("start-height")*n.width()/l.data("start-width"))}$();s.events.trigger("image.resize",[ze()])}}function T(e){if(!s.core.sameInstance(o))return true;if(l&&n){if(e)e.stopPropagation();if(s.$el.find("img.fr-error").left)return false;l=null;f.hide();$();w();s.undo.saveStep();s.events.trigger("image.resizeEnd",[ze()])}}function U(e,t,a){s.edit.on();if(n)n.addClass("fr-error");M(s.language.translate("Something went wrong. Please try again."));if(!n&&a)ve(a);s.events.trigger("image.error",[{code:e,message:b[e]},t,a])}function O(e){if(e){if(s.$wp){s.events.$on(s.$wp,"scroll",function(){if(n&&s.popups.isVisible("image.edit")){s.events.disableBlur();L(n)}})}return true}var t="";if(s.opts.imageEditButtons.length>0){t+='<div class="fr-buttons">';t+=s.button.buildList(s.opts.imageEditButtons);t+="</div>";var a={buttons:t};var i=s.popups.create("image.edit",a);return i}return false}function B(e){var t=s.popups.get("image.insert");if(!t)t=ae();t.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive");t.find(".fr-image-progress-bar-layer").addClass("fr-active");t.find(".fr-buttons").hide();if(n){s.popups.setContainer("image.insert",s.$sc);var a=n.offset().left+n.width()/2;var i=n.offset().top+n.height();s.popups.show("image.insert",a,i,n.outerHeight())}if(typeof e=="undefined"){P(s.language.translate("Uploading"),0)}}function _(e){var t=s.popups.get("image.insert");if(t){t.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive");t.find(".fr-image-progress-bar-layer").removeClass("fr-active");t.find(".fr-buttons").show();if(e||s.$el.find("img.fr-error").length){s.events.focus();if(s.$el.find("img.fr-error").length){s.$el.find("img.fr-error").remove();s.undo.saveStep();s.undo.run();s.undo.dropRedo()}if(!s.$wp&&n){var a=n;Re(true);s.selection.setAfter(a.get(0));s.selection.restore()}s.popups.hide("image.insert")}}}function P(e,t){var a=s.popups.get("image.insert");if(a){var i=a.find(".fr-image-progress-bar-layer");i.find("h3").text(e+(t?" "+t+"%":""));i.removeClass("fr-error");if(t){i.find("div").removeClass("fr-indeterminate");i.find("div > span").css("width",t+"%")}else{i.find("div").addClass("fr-indeterminate")}}}function M(e){B();var t=s.popups.get("image.insert");var a=t.find(".fr-image-progress-bar-layer");a.addClass("fr-error");var i=a.find("h3");i.text(e);s.events.disableBlur();i.focus()}function N(){var e=s.popups.get("image.insert");var t=e.find(".fr-image-by-url-layer input");if(t.val().length>0){B();P(s.language.translate("Loading image"));K(t.val(),true,[],n);t.val("");t.blur()}}function L(e){Se.call(e.get(0))}function z(){var t=e(this);s.popups.hide("image.insert");t.removeClass("fr-uploading");if(t.next().is("br")){t.next().remove()}L(t);s.events.trigger("image.loaded",[t])}function K(e,t,a,i,r){s.edit.off();P(s.language.translate("Loading image"));if(t)e=s.helpers.sanitizeURL(e);var n=new Image;n.onload=function(){var t;var n;if(i){if(!s.undo.canDo()&&!i.hasClass("fr-uploading"))s.undo.saveStep();var o=i.data("fr-old-src");if(i.data("fr-image-pasted")){o=null}if(s.$wp){t=i.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted");t.off("load");if(o)i.attr("src",o);i.replaceWith(t)}else{t=i}var l=t.get(0).attributes;for(var f=0;f<l.length;f++){var d=l[f];if(d.nodeName.indexOf("data-")===0){t.removeAttr(d.nodeName)}}if(typeof a!="undefined"){for(n in a){if(a.hasOwnProperty(n)){if(n!="path_external"&&n!="path_internal"){t.attr("data-"+n,a[n])}}}}t.on("load",z);t.attr("src",e);s.edit.on();x(false);s.undo.saveStep();s.$el.blur();s.events.trigger(o?"image.replaced":"image.inserted",[t,r])}else{t=G(e,a,z);x(false);s.undo.saveStep();s.events.trigger("image.inserted",[t,r])}};n.onerror=function(){U(p)};B(s.language.translate("Loading image"));n.src=e}function W(t){try{if(s.events.trigger("image.uploaded",[t],true)===false){s.edit.on();return false}var a=e.parseJSON(t);if(a.path_external||a.data.path_external){return a}else{U(g,t);return false}}catch(e){U(c,t);return false}}function H(t){try{var a=e(t).find("Location").text();var i=e(t).find("Key").text();if(s.events.trigger("image.uploadedToS3",[a,i,t],true)===false){s.edit.on();return false}return a}catch(e){U(c,t);return false}}function Y(e){P(s.language.translate("Loading image"));var a=this.status;var i=this.response;var n=this.responseXML;var o=this.responseText;try{if(s.opts.imageUploadToS3){if(a==201){var l=H(n);if(l){K(l,false,[],e,i||n)}}else{U(c,i||n,e)}}else{if(a>=200&&a<300){var f=W(o);if(f){var d;if(r=="admin"||r=="campaign-setup"||r=="campaign-manager"||r=="rewards"){if(f.path_external){d=t+"/static/images/"+f.path_external}else if(f.data.path_external){d=t+"/static/images/"+f.data.path_external}}K(d,false,f,e,i||o)}}else{U(u,i||o,e)}}}catch(t){U(c,i||o,e)}}function X(){U(c,this.response||this.responseText||this.responseXML)}function j(e){if(e.lengthComputable){var t=e.loaded/e.total*100|0;P(s.language.translate("Uploading"),t)}}function G(t,a,i){var r="";var n;if(a&&typeof a!="undefined"){for(n in a){if(a.hasOwnProperty(n)){if(n!="link"&&n!="path_internal"){r+=" data-"+n+'="'+a[n]+'"'}}}}var o=s.opts.imageDefaultWidth;if(o&&o!="auto"){o=o+(s.opts.imageResizeWithPercent?"%":"px")}var l=e('<img src="'+t+'"'+r+(o?' style="width: '+o+';"':"")+">");ke(l,s.opts.imageDefaultDisplay,s.opts.imageDefaultAlign);l.on("load",i);s.edit.on();s.events.focus(true);s.selection.restore();s.undo.saveStep();if(s.opts.imageSplitHTML){s.markers.split()}else{s.markers.insert()}var f=s.$el.find(".fr-marker");if(f.length){if(f.parent().is("hr")){f.parent().after(f)}if(s.node.isLastSibling(f)&&f.parent().hasClass("fr-deletable")){f.insertAfter(f.parent())}f.replaceWith(l)}else{s.$el.append(l)}s.html.wrap();s.selection.clear();return l}function q(){s.edit.on();_(true)}function V(t,a,i,r){function n(){var i=e(this);i.off("load");i.addClass("fr-uploading");if(i.next().is("br")){i.next().remove()}s.placeholder.refresh();if(!i.is(r))L(i);$();B();s.edit.off();t.onload=function(){Y.call(t,i)};t.onerror=X;t.upload.onprogress=j;t.onabort=q;i.off("abortUpload").on("abortUpload",function(){if(t.readyState!=4){t.abort()}});t.send(a)}var o=new FileReader;var l;o.addEventListener("load",function(){var e=o.result;if(o.result.indexOf("svg+xml")<0){var t=atob(o.result.split(",")[1]);var a=[];for(var i=0;i<t.length;i++){a.push(t.charCodeAt(i))}e=window.URL.createObjectURL(new Blob([new Uint8Array(a)],{type:"image/jpeg"}))}if(!r){l=G(e,null,n)}else{r.on("load",n);s.edit.on();s.undo.saveStep();r.data("fr-old-src",r.attr("src"));r.attr("src",e)}},false);o.readAsDataURL(i)}function Q(o,l){if(typeof o!="undefined"&&o.length>0){if(s.events.trigger("image.beforeUpload",[o])===false){return false}var f=o[0];if(!f.name){f.name=(new Date).getTime()+".jpg"}if(f.size>s.opts.imageMaxSize){U(m);return false}if(s.opts.imageAllowedTypes.indexOf(f.type.replace(/image\//g,""))<0){U(v);return false}var d;if(s.drag_support.formdata){d=s.drag_support.formdata?new FormData:null}if(d){var p;if(s.opts.imageUploadToS3!==false){d.append("key",s.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(f.name||"untitled"));d.append("success_action_status","201");d.append("X-Requested-With","xhr");d.append("Content-Type",f.type);for(p in s.opts.imageUploadToS3.params){if(s.opts.imageUploadToS3.params.hasOwnProperty(p)){d.append(p,s.opts.imageUploadToS3.params[p])}}}for(p in s.opts.imageUploadParams){if(s.opts.imageUploadParams.hasOwnProperty(p)){d.append(p,s.opts.imageUploadParams[p])}}d.append(s.opts.imageUploadParam,f);var g=s.opts.imageUploadURL;if(s.opts.imageUploadToS3){if(s.opts.imageUploadToS3.uploadURL){g=s.opts.imageUploadToS3.uploadURL}else{g="https://"+s.opts.imageUploadToS3.region+".amazonaws.com/"+s.opts.imageUploadToS3.bucket}}t=e("textarea[data-server]").attr("data-server");a=e("textarea[data-server]").attr("data-loc");i=window.location.pathname;r=i.split("/")[1];var u=new XMLHttpRequest;var c=new FormData;c.append("success_action_status","200");c.append("X-Requested-With","xhr");c.append("Content-Type",f.type);if(r=="admin"){var h=t+a+"portal/resource/file";u.open("POST",h,true);c.append("resource_type","file");c.append("resource_content_type","image");c.append("resource",f);c.append("region_id","1")}else if(r=="campaign-setup"||r=="rewards"||r=="campaign-manager"){var b;if(r=="campaign-manager"){b=i.split("/")[3]}else{b=i.split("/")[2]}var h=t+a+"campaign/"+b+"/resource/file";u.open("POST",h,true);c.append("entry_id",b);c.append("resource_type","file");c.append("resource_content_type","image");c.append("resource",f);c.append("region_id","2")}u.withCredentials=true;var y=n;u.onload=function(){Y.call(u,y)};u.onerror=X;u.upload.onprogress=j;B();s.edit.off();u.send(c)}}}function J(t){s.events.$on(t,"dragover dragenter",".fr-image-upload-layer",function(){e(this).addClass("fr-drop");return false});s.events.$on(t,"dragleave dragend",".fr-image-upload-layer",function(){e(this).removeClass("fr-drop");return false});s.events.$on(t,"drop",".fr-image-upload-layer",function(a){a.preventDefault();a.stopPropagation();e(this).removeClass("fr-drop");var i=a.originalEvent.dataTransfer;if(i&&i.files){var r=t.data("instance")||s;r.events.disableBlur();r.image.upload(i.files);r.events.enableBlur()}});s.events.$on(t,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var a=t.data("instance")||s;a.events.disableBlur();t.find("input:focus").blur();a.events.enableBlur();a.image.upload(this.files)}e(this).val("")})}function Z(t){var a=t.originalEvent.dataTransfer;if(a&&a.files&&a.files.length){var i=a.files[0];if(i&&i.type&&i.type.indexOf("image")!==-1){s.markers.remove();s.markers.insertAtPoint(t.originalEvent);s.$el.find(".fr-marker").replaceWith(e.FE.MARKERS);if(s.$el.find(".fr-marker").length===0){s.selection.setAtEnd(s.el)}s.popups.hideAll();var r=s.popups.get("image.insert");if(!r)r=ae();s.popups.setContainer("image.insert",s.$sc);var n=t.originalEvent.pageX;var o=t.originalEvent.pageY;if(s.opts.iframe){o+=s.$iframe.offset().top;n+=s.$iframe.offset().left}s.popups.show("image.insert",n,o);B();if(s.opts.imageAllowedTypes.indexOf(i.type.replace(/image\//g,""))>=0){Re(true);Q(a.files)}else{U(v)}t.preventDefault();t.stopPropagation();return false}}}function ee(){var t;var a;var i=s.selection.ranges(0);if(i.collapsed&&i.startContainer.nodeType==Node.ELEMENT_NODE){if(i.startContainer.childNodes.length==i.startOffset){t=i.startContainer.childNodes[i.startOffset-1];if(t&&t.tagName=="IMG"&&e(t).css("display")=="block"){a=s.node.blockParent(t);if(a&&s.html.defaultTag()){if(!a.nextSibling){if(["TD","TH"].indexOf(a.tagName)<0){e(a).after("<"+s.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+s.html.defaultTag()+">")}else{e(t).after("<br>"+e.FE.MARKERS)}s.selection.restore()}}else if(!a){e(t).after("<br>"+e.FE.MARKERS);s.selection.restore()}}}else if(i.startOffset===0&&i.startContainer.childNodes.length>i.startOffset){t=i.startContainer.childNodes[i.startOffset];if(t&&t.tagName=="IMG"&&e(t).css("display")=="block"){a=s.node.blockParent(t);if(a&&s.html.defaultTag()){if(!a.previousSibling){if(["TD","TH"].indexOf(a.tagName)<0){e(a).before("<"+s.html.defaultTag()+"><br>"+e.FE.MARKERS+"</"+s.html.defaultTag()+">")}else{e(t).before("<br>"+e.FE.MARKERS)}s.selection.restore()}}else if(!a){e(t).before(e.FE.MARKERS+"<br>");s.selection.restore()}}}}}function te(){s.events.$on(s.$el,s._mousedown,s.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(t){if(e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable")=="false")return true;if(!s.helpers.isMobile())s.selection.clear();d=true;if(s.popups.areVisible())s.events.disableBlur();if(s.browser.msie){s.events.disableBlur();s.$el.attr("contenteditable",false)}if(!s.draggable)t.preventDefault();t.stopPropagation()});s.events.$on(s.$el,s._mouseup,s.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(t){if(e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable")=="false")return true;if(d){d=false;t.stopPropagation();if(s.browser.msie){s.$el.attr("contenteditable",true);s.events.enableBlur()}}});s.events.on("keyup",function(t){if(t.shiftKey&&s.selection.text().replace(/\n/g,"")===""){var a=s.selection.element();var i=s.selection.endElement();if(a&&a.tagName=="IMG"){L(e(a))}else if(i&&i.tagName=="IMG"){L(e(i))}}},true);s.events.on("drop",Z);s.events.on("mousedown window.mousedown",xe);s.events.on("window.touchmove",$e);s.events.on("mouseup window.mouseup",function(){if(n){Re();return false}$e()});s.events.on("commands.mousedown",function(e){if(e.parents(".fr-toolbar").length>0){Re()}});if(!s.browser.edge){s.events.on("mouseup",ee)}s.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){d=false;Re(true)});s.events.on("modals.hide",function(){if(n){Ne();s.selection.clear()}})}function ae(e){if(e){s.popups.onRefresh("image.insert",y);s.popups.onHide("image.insert",C);return true}var t;var a="";if(s.opts.imageInsertButtons.length>1){a='<div class="fr-buttons">'+s.button.buildList(s.opts.imageInsertButtons)+"</div>"}var i=s.opts.imageInsertButtons.indexOf("imageUpload");var r=s.opts.imageInsertButtons.indexOf("imageByURL");var o="";if(i>=0){t=" fr-active";if(r>=0&&i>r){t=""}o='<div class="fr-image-upload-layer'+t+' fr-layer" id="fr-image-upload-layer-'+s.id+'"><strong>'+s.language.translate("Drop image")+"</strong><br>("+s.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+s.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+s.id+'" role="button"></div></div>'}var l="";if(r>=0){t=" fr-active";if(i>=0&&r>i){t=""}l='<div class="fr-image-by-url-layer'+t+' fr-layer" id="fr-image-by-url-layer-'+s.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+s.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+s.language.translate("Insert")+"</button></div></div>"}var f='<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>';var d={buttons:a,upload_layer:o,by_url_layer:l,progress_bar:f};var p=s.popups.create("image.insert",d);if(s.$wp){s.events.$on(s.$wp,"scroll",function(){if(n&&s.popups.isVisible("image.insert")){Me()}})}J(p);return p}function ie(){if(n){var e=s.popups.get("image.alt");e.find("input").val(n.attr("alt")||"").trigger("change")}}function re(){var e=s.popups.get("image.alt");if(!e)e=se();_();s.popups.refresh("image.alt");s.popups.setContainer("image.alt",s.$sc);var t=n.offset().left+n.width()/2;var a=n.offset().top+n.height();s.popups.show("image.alt",t,a,n.outerHeight())}function se(e){if(e){s.popups.onRefresh("image.alt",ie);return true}var t="";t='<div class="fr-buttons">'+s.button.buildList(s.opts.imageAltButtons)+"</div>";var a="";a='<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+s.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+s.id+'" type="text" placeholder="'+s.language.translate("Alternate Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+s.language.translate("Update")+"</button></div></div>";var i={buttons:t,alt_layer:a};var r=s.popups.create("image.alt",i);if(s.$wp){s.events.$on(s.$wp,"scroll.image-alt",function(){if(n&&s.popups.isVisible("image.alt")){re()}})}return r}function ne(e){if(n){var t=s.popups.get("image.alt");n.attr("alt",e||t.find("input").val()||"");t.find("input:focus").blur();L(n)}}function oe(){if(n){var e=s.popups.get("image.size");e.find('input[name="width"]').val(n.get(0).style.width).trigger("change");e.find('input[name="height"]').val(n.get(0).style.height).trigger("change")}}function le(){var e=s.popups.get("image.size");if(!e)e=fe();_();s.popups.refresh("image.size");s.popups.setContainer("image.size",s.$sc);var t=n.offset().left+n.width()/2;var a=n.offset().top+n.height();s.popups.show("image.size",t,a,n.outerHeight())}function fe(e){if(e){s.popups.onRefresh("image.size",oe);return true}var t="";t='<div class="fr-buttons">'+s.button.buildList(s.opts.imageSizeButtons)+"</div>";var a="";a='<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+s.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+s.id+'" type="text" name="width" placeholder="'+s.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+s.id+'" type="text" name="height" placeholder="'+s.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+s.language.translate("Update")+"</button></div></div>";var i={buttons:t,size_layer:a};var r=s.popups.create("image.size",i);if(s.$wp){s.events.$on(s.$wp,"scroll.image-size",function(){if(n&&s.popups.isVisible("image.size")){le()}})}return r}function de(e,t){if(n){var a=s.popups.get("image.size");e=e||a.find('input[name="width"]').val()||"";t=t||a.find('input[name="height"]').val()||"";var i=/^[\d]+((px)|%)*$/g;if(e.match(i))n.css("width",e);else n.css("width","");if(t.match(i))n.css("height",t);else n.css("height","");a.find("input:focus").blur();L(n)}}function pe(e){var t=s.popups.get("image.insert");var a;var i;if(!n&&!s.opts.toolbarInline){var r=s.$tb.find('.fr-command[data-cmd="insertImage"]');a=r.offset().left+r.outerWidth()/2;i=r.offset().top+(s.opts.toolbarBottom?10:r.outerHeight()-10)}else if(n){i=n.offset().top+n.outerHeight()}if(!n&&s.opts.toolbarInline){i=t.offset().top-s.helpers.getPX(t.css("margin-top"));if(t.hasClass("fr-above")){i+=t.outerHeight()}}t.find(".fr-layer").removeClass("fr-active");t.find(".fr-"+e+"-layer").addClass("fr-active");s.popups.show("image.insert",a,i,n?n.outerHeight():0);s.accessibility.focusPopup(t)}function ge(e){var t=s.popups.get("image.insert");if(t.find(".fr-image-upload-layer").hasClass("fr-active")){e.addClass("fr-active").attr("aria-pressed",true)}}function ue(e){var t=s.popups.get("image.insert");if(t.find(".fr-image-by-url-layer").hasClass("fr-active")){e.addClass("fr-active").attr("aria-pressed",true)}}function ce(e,t,a,i){e.pageX=t;k.call(this,e);e.pageX=e.pageX+a*Math.floor(Math.pow(1.1,i));F.call(this,e);T.call(this,e);return++i}function me(){var t;if(!s.shared.$image_resizer){s.shared.$image_resizer=e('<div class="fr-image-resizer"></div>');o=s.shared.$image_resizer;s.events.$on(o,"mousedown",function(e){e.stopPropagation()},true);if(s.opts.imageResize){o.append(I("nw")+I("ne")+I("sw")+I("se"));s.shared.$img_overlay=e('<div class="fr-image-overlay"></div>');f=s.shared.$img_overlay;t=o.get(0).ownerDocument;e(t).find("body:first").append(f)}}else{o=s.shared.$image_resizer;f=s.shared.$img_overlay;s.events.on("destroy",function(){o.removeClass("fr-active").appendTo(e("body:first"))},true)}s.events.on("shared.destroy",function(){o.html("").removeData().remove();o=null;if(s.opts.imageResize){f.remove();f=null}},true);if(!s.helpers.isMobile()){s.events.$on(e(s.o_win),"resize",function(){if(n&&!n.hasClass("fr-uploading")){Re(true)}else if(n){$();Me();B(false)}})}if(s.opts.imageResize){t=o.get(0).ownerDocument;s.events.$on(o,s._mousedown,".fr-handler",k);s.events.$on(e(t),s._mousemove,F);s.events.$on(e(t.defaultView||t.parentWindow),s._mouseup,T);s.events.$on(f,"mouseleave",T);var a=1;var i=null;var r=0;s.events.on("keydown",function(t){if(n){var o=navigator.userAgent.indexOf("Mac OS X")!=-1?t.metaKey:t.ctrlKey;var l=t.which;if(l!==i||t.timeStamp-r>200){a=1}if((l==e.FE.KEYCODE.EQUALS||s.browser.mozilla&&l==e.FE.KEYCODE.FF_EQUALS)&&o&&!t.altKey){a=ce.call(this,t,1,1,a)}else if((l==e.FE.KEYCODE.HYPHEN||s.browser.mozilla&&l==e.FE.KEYCODE.FF_HYPHEN)&&o&&!t.altKey){a=ce.call(this,t,2,-1,a)}else if(!s.keys.ctrlKey(t)&&l==e.FE.KEYCODE.ENTER){n.before("<br>");L(n)}i=l;r=t.timeStamp}},true);s.events.on("keyup",function(){a=1})}}function ve(t){t=t||n;if(t){if(s.events.trigger("image.beforeRemove",[t])!==false){s.popups.hideAll();Ne();Re(true);if(!s.undo.canDo())s.undo.saveStep();if(t.get(0)==s.el){t.removeAttr("src")}else{if(t.get(0).parentNode.tagName=="A"){s.selection.setBefore(t.get(0).parentNode)||s.selection.setAfter(t.get(0).parentNode)||t.parent().after(e.FE.MARKERS);e(t.get(0).parentNode).remove()}else{s.selection.setBefore(t.get(0))||s.selection.setAfter(t.get(0))||t.after(e.FE.MARKERS);t.remove()}s.html.fillEmptyBlocks();s.selection.restore()}s.undo.saveStep()}}}function he(t){var a=t.which;if(n&&(a==e.FE.KEYCODE.BACKSPACE||a==e.FE.KEYCODE.DELETE)){t.preventDefault();t.stopPropagation();ve();return false}else if(n&&a==e.FE.KEYCODE.ESC){var i=n;Re(true);s.selection.setAfter(i.get(0));s.selection.restore();t.preventDefault();return false}else if(n&&(a==e.FE.KEYCODE.ARROW_LEFT||a==e.FE.KEYCODE.ARROW_RIGHT)){var r=n.get(0);Re(true);if(a==e.FE.KEYCODE.ARROW_LEFT){s.selection.setBefore(r)}else{s.selection.setAfter(r)}s.selection.restore();t.preventDefault();return false}else if(n&&a!=e.FE.KEYCODE.F10&&!s.keys.isBrowserAction(t)){t.preventDefault();t.stopPropagation();return false}}function be(e){if(e&&e.tagName=="IMG"){if(s.node.hasClass(e,"fr-uploading")||s.node.hasClass(e,"fr-error")){e.parentNode.removeChild(e)}else if(s.node.hasClass(e,"fr-draggable")){e.classList.remove("fr-draggable")}}else if(e&&e.nodeType==Node.ELEMENT_NODE){var t=e.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable");for(var a=0;a<t.length;a++){be(t[a])}}}function ye(){te();if(s.el.tagName=="IMG"){s.$el.addClass("fr-view")}s.events.$on(s.$el,s.helpers.isMobile()&&!s.helpers.isWindowsPhone()?"touchend":"click",s.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',Se);if(s.helpers.isMobile()){s.events.$on(s.$el,"touchstart",s.el.tagName=="IMG"?null:'img:not([contenteditable="false"])',function(){Ae=false});s.events.$on(s.$el,"touchmove",function(){Ae=true})}if(s.$wp){s.events.on("window.keydown keydown",he,true);s.events.on("keyup",function(t){if(n&&t.which==e.FE.KEYCODE.ENTER){return false}},true)}else{s.events.$on(s.$win,"keydown",he)}s.events.on("toolbar.esc",function(){if(n){if(s.$wp){s.events.disableBlur();s.events.focus()}else{var e=n;Re(true);s.selection.setAfter(e.get(0));s.selection.restore()}return false}},true);s.events.on("toolbar.focusEditor",function(){if(n){return false}},true);s.events.on("window.cut window.copy",function(e){if(n&&s.popups.isVisible("image.edit")&&!s.popups.get("image.edit").find(":focus").length){Ne();s.paste.saveCopiedText(n.get(0).outerHTML,"\n");if(e.type=="copy"){setTimeout(function(){L(n)})}else{Re(true);s.undo.saveStep();setTimeout(function(){s.undo.saveStep()},0)}}},true);s.events.$on(e(s.o_win),"keydown",function(t){var a=t.which;if(n&&a==e.FE.KEYCODE.BACKSPACE){t.preventDefault();return false}});s.events.$on(s.$win,"keydown",function(t){var a=t.which;if(n&&n.hasClass("fr-uploading")&&a==e.FE.KEYCODE.ESC){n.trigger("abortUpload")}});s.events.on("destroy",function(){if(n&&n.hasClass("fr-uploading")){n.trigger("abortUpload")}});s.events.on("paste.before",we);s.events.on("paste.beforeCleanup",Ce);s.events.on("paste.after",Ee);s.events.on("html.set",R);s.events.on("html.inserted",R);R();s.events.on("destroy",function(){D=[]});s.events.on("html.processGet",be);if(s.opts.imageOutputSize){var t;s.events.on("html.beforeGet",function(){t=s.el.querySelectorAll("img");for(var a=0;a<t.length;a++){var i=t[a].style.width||e(t[a]).width();var r=t[a].style.height||e(t[a]).height();if(i)t[a].setAttribute("width",(""+i).replace(/px/,""));if(r)t[a].setAttribute("height",(""+r).replace(/px/,""))}})}if(s.opts.iframe){s.events.on("image.loaded",s.size.syncIframe)}if(s.$wp){x();s.events.on("contentChanged",x)}s.events.$on(e(s.o_win),"orientationchange.image",function(){setTimeout(function(){if(n){L(n)}},100)});O(true);ae(true);fe(true);se(true);s.events.on("node.remove",function(e){if(e.get(0).tagName=="IMG"){ve(e);return false}})}function Ee(){if(!s.opts.imagePaste){s.$el.find("img[data-fr-image-pasted]").remove()}else{s.$el.find("img[data-fr-image-pasted]").each(function(t,a){if(s.opts.imagePasteProcess){var i=s.opts.imageDefaultWidth;if(i&&i!="auto"){i=i+(s.opts.imageResizeWithPercent?"%":"px")}e(a).css("width",i);e(a).removeClass("fr-dii fr-dib fr-fir fr-fil").addClass((s.opts.imageDefaultDisplay?"fr-di"+s.opts.imageDefaultDisplay[0]:"")+(s.opts.imageDefaultAlign?s.opts.imageDefaultAlign!="center"?" fr-fi"+s.opts.imageDefaultAlign[0]:"":""))}if(a.src.indexOf("data:")===0){if(s.events.trigger("image.beforePasteUpload",[a])===false){return false}n=e(a);$();w();Me();B();s.edit.off();var r=atob(e(a).attr("src").split(",")[1]);var o=[];for(var l=0;l<r.length;l++){o.push(r.charCodeAt(l))}var f=new Blob([new Uint8Array(o)],{type:"image/jpeg"});Q([f],n)}else if(a.src.indexOf("http")!==0||a.src.indexOf("https://mail.google.com/mail")===0){s.selection.save();e(a).remove();s.selection.restore()}else{e(a).removeAttr("data-fr-image-pasted")}})}}function we(e){if(e&&e.clipboardData){if(e.clipboardData.items&&e.clipboardData.items[0]){var t=e.clipboardData.items[0].getAsFile();if(t){var a=new FileReader;a.onload=function(e){var t=e.target.result;var a=s.opts.imageDefaultWidth;if(a&&a!="auto"){a=a+(s.opts.imageResizeWithPercent?"%":"px")}s.html.insert('<img data-fr-image-pasted="true" class="'+(s.opts.imageDefaultDisplay?"fr-di"+s.opts.imageDefaultDisplay[0]:"")+(s.opts.imageDefaultAlign?s.opts.imageDefaultAlign!="center"?" fr-fi"+s.opts.imageDefaultAlign[0]:"":"")+'" src="'+t+'"'+(a?' style="width: '+a+';"':"")+">");s.events.trigger("paste.after")};a.readAsDataURL(t);return false}}}}function Ce(e){e=e.replace(/<img /gi,'<img data-fr-image-pasted="true" ');return e}var Ae;function Se(t){if(e(this).parents("[contenteditable]:not(.fr-element):not(body):first").attr("contenteditable")=="false")return true;if(t&&t.type=="touchend"&&Ae){return true}if(t&&s.edit.isDisabled()){t.stopPropagation();t.preventDefault();return false}for(var a=0;a<e.FE.INSTANCES.length;a++){if(e.FE.INSTANCES[a]!=s){e.FE.INSTANCES[a].events.trigger("image.hideResizer")}}s.toolbar.disable();if(t){t.stopPropagation();t.preventDefault()}if(s.helpers.isMobile()){s.events.disableBlur();s.$el.blur();s.events.enableBlur()}if(s.opts.iframe){s.size.syncIframe()}n=e(this);Ne();$();w();s.selection.clear();s.button.bulkRefresh();s.events.trigger("video.hideResizer")}function Re(e){if(n&&(Ie()||e===true)){s.toolbar.enable();o.removeClass("fr-active");s.popups.hide("image.edit");n=null;$e()}}var De=false;function xe(){De=true}function $e(){De=false}function Ie(){return De}function ke(e,t,a){if(!s.opts.htmlUntouched&&s.opts.useClasses){e.removeClass("fr-fil fr-fir fr-dib fr-dii");if(a){e.addClass("fr-fi"+a[0])}if(t){e.addClass("fr-di"+t[0])}}else{if(t=="inline"){e.css({display:"inline-block",verticalAlign:"bottom",margin:s.opts.imageDefaultMargin});if(a=="center"){e.css({float:"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - "+2*s.opts.imageDefaultMargin+"px)"})}else if(a=="left"){e.css({float:"left",marginLeft:0,maxWidth:"calc(100% - "+s.opts.imageDefaultMargin+"px)"})}else{e.css({float:"right",marginRight:0,maxWidth:"calc(100% - "+s.opts.imageDefaultMargin+"px)"})}}else if(t=="block"){e.css({display:"block",float:"none",verticalAlign:"top",margin:s.opts.imageDefaultMargin+"px auto"});if(a=="left"){e.css({marginLeft:0})}else if(a=="right"){e.css({marginRight:0})}}}}function Fe(e){n.removeClass("fr-fir fr-fil");if(!s.opts.htmlUntouched&&s.opts.useClasses){if(e=="left"){n.addClass("fr-fil")}else if(e=="right"){n.addClass("fr-fir")}}else{ke(n,Ue(),e)}Ne();$();w();s.selection.clear()}function Te(e){if(typeof e=="undefined")e=n;if(e){if(e.hasClass("fr-fil")){return"left"}else if(e.hasClass("fr-fir")){return"right"}else if(e.hasClass("fr-dib")||e.hasClass("fr-dii")){return"center"}else{var t=e.css("float");e.css("float","none");if(e.css("display")=="block"){e.css("float","");if(e.css("float")!=t)e.css("float",t);if(parseInt(e.css("margin-left"),10)===0){return"left"}else if(parseInt(e.css("margin-right"),10)===0){return"right"}}else{e.css("float","");if(e.css("float")!=t)e.css("float",t);if(e.css("float")=="left"){return"left"}else if(e.css("float")=="right"){return"right"}}}}return"center"}function Ue(e){if(typeof e=="undefined")e=n;var t=e.css("float");e.css("float","none");if(e.css("display")=="block"){e.css("float","");if(e.css("float")!=t)e.css("float",t);return"block"}else{e.css("float","");if(e.css("float")!=t)e.css("float",t);return"inline"}return"inline"}function Oe(e){if(n){e.find("> *:first").replaceWith(s.icon.create("image-align-"+Te()))}}function Be(e,t){if(n){t.find('.fr-command[data-param1="'+Te()+'"]').addClass("fr-active").attr("aria-selected",true)}}function _e(e){n.removeClass("fr-dii fr-dib");if(!s.opts.htmlUntouched&&s.opts.useClasses){if(e=="inline"){n.addClass("fr-dii")}else if(e=="block"){n.addClass("fr-dib")}}else{ke(n,e,Te())}Ne();$();w();s.selection.clear()}function Pe(e,t){if(n){t.find('.fr-command[data-param1="'+Ue()+'"]').addClass("fr-active").attr("aria-selected",true)}}function Me(){var e=s.popups.get("image.insert");if(!e)e=ae();if(!s.popups.isVisible("image.insert")){_();s.popups.refresh("image.insert");s.popups.setContainer("image.insert",s.$sc)}var t=n.offset().left+n.width()/2;var a=n.offset().top+n.height();s.popups.show("image.insert",t,a,n.outerHeight())}function Ne(){if(n){s.selection.clear();var e=s.doc.createRange();e.selectNode(n.get(0));var t=s.selection.get();t.addRange(e)}}function Le(){if(n){s.events.disableBlur();e(".fr-popup input:focus").blur();L(n)}else{s.events.disableBlur();s.selection.restore();s.events.enableBlur();s.popups.hide("image.insert");s.toolbar.showInline()}}function ze(){return n}function Ke(e,t,a){if(typeof t=="undefined")t=s.opts.imageStyles;if(typeof a=="undefined")a=s.opts.imageMultipleStyles;if(!n)return false;if(!a){var i=Object.keys(t);i.splice(i.indexOf(e),1);n.removeClass(i.join(" "))}if(typeof t[e]=="object"){n.removeAttr("style");n.css(t[e].style)}else{n.toggleClass(e)}L(n)}return{_init:ye,showInsertPopup:E,showLayer:pe,refreshUploadButton:ge,refreshByURLButton:ue,upload:Q,insertByURL:N,align:Fe,refreshAlign:Oe,refreshAlignOnShow:Be,display:_e,refreshDisplayOnShow:Pe,replace:Me,back:Le,get:ze,insert:K,showProgressBar:B,remove:ve,hideProgressBar:_,applyStyle:Ke,showAltPopup:re,showSizePopup:le,setAlt:ne,setSize:de,exitEdit:Re,edit:L}};e.FE.DefineIcon("insertImage",{NAME:"image"});e.FE.RegisterShortcut(e.FE.KEYCODE.P,"insertImage",null,"P");e.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:false,focus:true,refreshAfterCallback:false,popup:true,callback:function(){if(!this.popups.isVisible("image.insert")){this.image.showInsertPopup()}else{if(this.$el.find(".fr-marker").length){this.events.disableBlur();this.selection.restore()}this.popups.hide("image.insert")}},plugin:"image"});e.FE.DefineIcon("imageUpload",{NAME:"upload"});e.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:false,focus:false,toggle:true,callback:function(){this.image.showLayer("image-upload")},refresh:function(e){this.image.refreshUploadButton(e)}});e.FE.DefineIcon("imageByURL",{NAME:"link"});e.FE.RegisterCommand("imageByURL",{title:"By URL",undo:false,focus:false,toggle:true,callback:function(){this.image.showLayer("image-by-url")},refresh:function(e){this.image.refreshByURLButton(e)}});e.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:true,refreshAfterCallback:false,callback:function(){this.image.insertByURL()},refresh:function(e){var t=this.image.get();if(!t){e.text(this.language.translate("Insert"))}else{e.text(this.language.translate("Replace"))}}});e.FE.DefineIcon("imageDisplay",{NAME:"star"});e.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.image.display(t)},refresh:function(e){if(!this.opts.imageTextNear)e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.image.refreshDisplayOnShow(e,t)}});e.FE.DefineIcon("image-align",{NAME:"align-left"});e.FE.DefineIcon("image-align-left",{NAME:"align-left"});e.FE.DefineIcon("image-align-right",{NAME:"align-right"});e.FE.DefineIcon("image-align-center",{NAME:"align-justify"});e.FE.DefineIcon("imageAlign",{NAME:"align-justify"});e.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list" role="presentation">';var a=e.FE.COMMANDS.imageAlign.options;for(var i in a){if(a.hasOwnProperty(i)){t+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+i+'" title="'+this.language.translate(a[i])+'">'+this.icon.create("image-align-"+i)+'<span class="fr-sr-only">'+this.language.translate(a[i])+"</span></a></li>"}}t+="</ul>";return t},callback:function(e,t){this.image.align(t)},refresh:function(e){this.image.refreshAlign(e)},refreshOnShow:function(e,t){this.image.refreshAlignOnShow(e,t)}});e.FE.DefineIcon("imageReplace",{NAME:"exchange"});e.FE.RegisterCommand("imageReplace",{title:"Replace",undo:false,focus:false,popup:true,refreshAfterCallback:false,callback:function(){this.image.replace()}});e.FE.DefineIcon("imageRemove",{NAME:"trash"});e.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}});e.FE.DefineIcon("imageBack",{NAME:"arrow-left"});e.FE.RegisterCommand("imageBack",{title:"Back",undo:false,focus:false,back:true,callback:function(){this.image.back()},refresh:function(e){var t=this.image.get();if(!t&&!this.opts.toolbarInline){e.addClass("fr-hidden");e.next(".fr-separator").addClass("fr-hidden")}else{e.removeClass("fr-hidden");e.next(".fr-separator").removeClass("fr-hidden")}}});e.FE.RegisterCommand("imageDismissError",{title:"OK",undo:false,callback:function(){this.image.hideProgressBar(true)}});e.FE.DefineIcon("imageStyle",{NAME:"magic"});e.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">';var t=this.opts.imageStyles;for(var a in t){if(t.hasOwnProperty(a)){var i=t[a];if(typeof i=="object")i=i.title;e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+a+'">'+this.language.translate(i)+"</a></li>"}}e+="</ul>";return e},callback:function(e,t){this.image.applyStyle(t)},refreshOnShow:function(t,a){var i=this.image.get();if(i){a.find(".fr-command").each(function(){var t=e(this).data("param1");var a=i.hasClass(t);e(this).toggleClass("fr-active",a).attr("aria-selected",a)})}}});e.FE.DefineIcon("imageAlt",{NAME:"info"});e.FE.RegisterCommand("imageAlt",{undo:false,focus:false,popup:true,title:"Alternate Text",callback:function(){this.image.showAltPopup()}});e.FE.RegisterCommand("imageSetAlt",{undo:true,focus:false,title:"Update",refreshAfterCallback:false,callback:function(){this.image.setAlt()}});e.FE.DefineIcon("imageSize",{NAME:"arrows-alt"});e.FE.RegisterCommand("imageSize",{undo:false,focus:false,popup:true,title:"Change Size",callback:function(){this.image.showSizePopup()}});e.FE.RegisterCommand("imageSetSize",{undo:true,focus:false,title:"Update",refreshAfterCallback:false,callback:function(){this.image.setSize()}})});